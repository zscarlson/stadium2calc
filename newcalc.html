<!DOCTYPE html>
<html>
<head>
<style>
table, th, td {
  border: 1px solid black;
}
</style>
</head>
<body>

<img src="Ani106MS.png", onclick="setAttacker(Hitmonlee); calcAll(attacker,defender)">
<img src="Ani208MS.png", onclick="setAttacker(Steelix); calcAll(attacker,defender)">
<br>
<img src="Ani241MS.png", onclick="setDefender(TerryMiltank); calcAll(attacker,defender)">
<img src="Ani053MS.png", onclick="setDefender(MartyPersian); calcAll(attacker,defender)">
<br>

<table class=calcdisplay style="text-align:center">

	<tr>
		<td>
			<img src="Spr_5b_132.png", id="sprite1", onclick="calcAll(attacker,defender)">
			<p id="Item1"></p>
			<p id="HP1"></p>
			<p id="Speed1"></p>
		</td>
		<td>
			<img src="Spr_5b_132.png", id="sprite2", onclick="calcAll(attacker,defender)">
			<p id="Item2"></p>
			<p id="HP2"></p>
			<p id="Speed2"></p>
		</td>
	</tr>

	<tr>
		<td>
			<p id="calcresult1"></p>
			<p id="KO1"></p>
		</td>
		<td>
			<p id="calcresult5"></p>
			<p id="KO5"></p>
		</td>
	</tr>
	<tr>
		<td>
			<p id="calcresult2"></p>
			<p id="KO2"></p>
		</td>
		<td>
			<p id="calcresult6"></p>
			<p id="KO6"></p>
		</td>
	</tr>
	<tr>
		<td>
			<p id="calcresult3"></p>
			<p id="KO3"></p>
		</td>
		<td>
			<p id="calcresult7"></p>
			<p id="KO7"></p>
		</td>
	</tr>
	<tr>
		<td>
			<p id="calcresult4"></p>
			<p id="KO4"></p>
		</td>
		<td>
			<p id="calcresult8"></p>
			<p id="KO8"></p>
		</td>
	</tr>
</table>


<script>

var attacker = "unselected";
var defender = "unselected";
var reversalPower = 20;
		
const Hitmonlee = {
	Name: "Hitmonlee", Number: "106", Type1: "Fighting", Type2: "none", Level: 100, Item: "none",
	HP: 263, Attack: 300, Defense: 164, SpAtk: 128, SpDef: 278, Speed: 234,
	Move1: {name: "Hi Jump Kick", type: "Fighting", category: "Physical", power: 85},
	Move2: {name: "Mega Kick", type: "Normal", category: "Physical", power: 120},
	Move3: {name: "Reversal", type: "Fighting", category: "Physical", power: reversalPower},
	Move4: {name: "Meditate", type: "Psychic", category: "Status", power: 0}
}

const Steelix = {
	Name: "Steelix", Number: "208", Type1: "Ground", Type2: "Steel", Level: 100, Item: "none",
	HP: 303, Attack: 218, Defense: 448, SpAtk: 158, SpDef: 178, Speed: 106,
	Move1: {name: "Iron Tail", type: "Steel", category: "Physical", power: 100},
	Move2: {name: "Mud Slap", type: "Ground", category: "Physical", power: 20},
	Move3: {name: "Rock Throw", type: "Rock", category: "Physical", power: 50},
	Move4: {name: "Sandstorm", type: "Rock", category: "Status", power: 0}
}

const TerryMiltank = {
	Name: "Miltank", Number: "241", Type1: "Normal", Type2: "none", Level: 100, Item: "Scope Lens",
	HP: 350, Attack: 229, Defense: 281, SpAtk: 151, SpDef: 211, Speed: 269,
	Move1: {name: "Strength", type: "Normal", category: "Physical", power: 80},
	Move2: {name: "Seismic Toss", type: "Fighting", category: "Physical", power: "?"},
	Move3: {name: "Attract", type: "Normal", category: "Status", power: 0},
	Move4: {name: "Heal Bell", type: "Normal", category: "Status", power: 0}
}

const MartyPersian = {
	Name: "Persian", Number: "053", Type1: "Normal", Type2: "none", Level: 100, Item: "King's Rock",
	HP: 318, Attack: 215, Defense: 205, SpAtk: 217, SpDef: 217, Speed: 317,
	Move1: {name: "Body Slam", type: "Normal", category: "Physical", power: 85},
	Move2: {name: "Thunderbolt", type: "Electric", category: "Special", power: "95"},
	Move3: {name: "Bite", type: "Dark", category: "Special", power: 60},
	Move4: {name: "Hypnosis", type: "Psychic", category: "Status", power: 0}
}

function calcAll(attacker, defender){
	if((attacker !== "unselected") & (defender !== "unselected")){
	calcMove(attacker,defender,1,1);
	calcMove(attacker,defender,2,2);
	calcMove(attacker,defender,3,3);
	calcMove(attacker,defender,4,4);
	calcMove(defender,attacker,1,5);
	calcMove(defender,attacker,2,6);
	calcMove(defender,attacker,3,7);
	calcMove(defender,attacker,4,8);
	}
}

function setAttacker(pkmn){
	attacker = pkmn;
	document.getElementById('sprite1').src = pkmn.Number + ".png";
	document.getElementById('HP1').innerHTML = pkmn.HP + " HP";
	document.getElementById('Speed1').innerHTML = pkmn.Speed + " Speed";
	if(pkmn.Item == "none"){
		document.getElementById('Item1').innerHTML = "";
	}
	else{
		document.getElementById('Item1').innerHTML = "@ " + pkmn.Item;
	}
	
}

function setDefender(pkmn){
	defender = pkmn;
	document.getElementById('sprite2').src = pkmn.Number + ".png";
	document.getElementById('HP2').innerHTML = pkmn.HP + " HP";
	document.getElementById('Speed2').innerHTML = pkmn.Speed + " Speed";
	document.getElementById('Item2').innerHTML = "@ " + pkmn.Item;
	if(pkmn.Item == "none"){
		document.getElementById('Item2').innerHTML = "";
	}
	else{
		document.getElementById('Item2').innerHTML = "@ " + pkmn.Item;
	}
}

function calcMove(attacker,defender,moveslot,resultslot){
	if (moveslot == 1)
	{
		movename = attacker.Move1.name;
		bp = attacker.Move1.power;
		movetype = attacker.Move1.type;
		category = attacker.Move1.category;
	}
	if (moveslot == 2)
	{
		movename = attacker.Move2.name
		bp = attacker.Move2.power;
		movetype = attacker.Move2.type;
		category = attacker.Move2.category;
	}
	if (moveslot == 3)
	{
		movename = attacker.Move3.name
		bp = attacker.Move3.power;
		movetype = attacker.Move3.type;
		category = attacker.Move3.category;
	}
	if (moveslot == 4)
	{
		movename = attacker.Move4.name
		bp = attacker.Move4.power;
		movetype = attacker.Move4.type;
		category = attacker.Move4.category;
	}

	//THIS IS WHERE YOU NEED TO PUT IN THE ACTUAL TYPE CHART

	type = 1;

	if ((defender.Type1 == "Normal") || (defender.Type2 == "Normal"))
		{
			if (movetype == "Fighting"){
				type = type*2;
			}
			if (movetype == "Ghost"){
				type = type*0;
			}
		}
	if (movetype == "Normal" & defender.Type2 == "Steel"){
		type = 0.5;
	}
	if (movetype == "Dark" & defender.Type2 == "Steel"){
		type = 0.5;
	}
	if (movetype == "Electric" & defender.Type1 == "Ground"){
		type = 0;
	}

	lvl = attacker.Level;
	stab = 1;
	if (movetype == attacker.Type1){
		stab = 1.5;
	}
	if (movetype == attacker.Type2){
		stab = 1.5;
	}

	if (category == "Physical")
	  {
	    def = defender.Defense;
	    atk = attacker.Attack;
	  }
	  if (category == "Special")
	  {
	  	def = defender.SpDef;
	  	atk = attacker.SpAtk;
	  }

	  var inter1 = Math.floor(lvl*0.4 + 2);
	  var inter2 = Math.floor(inter1*atk*bp/50);
	  var inter3 = Math.floor((inter2/def)+2);
	  var inter4 = Math.floor(inter3*stab);
	  var maxroll = Math.floor(inter4*type);
	  var minroll = Math.floor(maxroll*217/255);


	  //THIS IS WHERE EXCEPTIONS FOR THINGS LIKE FIXED DAMAGE MOVES, MULTI STRIKE, ETC GO

	  if (movename == "Seismic Toss"){
	  	minroll = attacker.Level;
	  	maxroll = attacker.Level;
	  	if ((defender.Type1 == "Ghost") || (defender.Type2 == "Ghost")){
	  		minroll = 0;
	  		maxroll = 0;
	  	}
	  }

	document.getElementById('calcresult' + resultslot).innerHTML = movename + "<br>" + minroll + " - " + maxroll

	if (minroll == maxroll){
		document.getElementById('calcresult' + resultslot).innerHTML = movename + "<br>" + minroll
	}

	if(minroll == maxroll){
		fixedChecker(maxroll,defender.HP,resultslot);
	}
	else if (maxroll >= defender.HP){
		OneHitChecker(maxroll,defender.HP,resultslot);	
	}
	else if (maxroll >= defender.HP/2){
		TwoHitChecker(maxroll,defender.HP,resultslot);	
	}
	else if (maxroll >= defender.HP/3){
		ThreeHitChecker(maxroll,defender.HP,resultslot);	
	}
	else if (maxroll >= defender.HP/4){
		FourHitChecker(maxroll,defender.HP,resultslot);	
	}
	else{
		document.getElementById('KO' + resultslot).innerHTML = ""
	}

	if (bp == 0){
		document.getElementById('calcresult' + resultslot).innerHTML = movename;
		document.getElementById('KO' + resultslot).innerHTML = ""
	}
}

function OneHitChecker(maxroll,HP,resultslot){
	count = 0;
	hp = HP;
	var i;
	for (i = 217; i < 256; i++)
	{
		damage = Math.floor(maxroll*i/255);
		if (damage >= hp){
			count = count + 1;
		}
	}
	var OneHitChance = Math.round(count * 10000/39) / 100;
	document.getElementById('KO' + resultslot).innerHTML = OneHitChance + "% OHKO";
	// if(OneHitChance == 100){
	// 	document.getElementById('KO' + resultslot).innerHTML = "Guaranteed OHKO";
	// }
}

function TwoHitChecker(maxroll,HP,resultslot){
	count = 0;
	hp = HP;
	var i;
	var j;
	for (i = 217; i < 256; i++)
	{
		for (j = 217; j < 256; j++){
			damage = Math.floor(maxroll*i/255) + Math.floor(maxroll*j/255);
				if (damage >= hp){
					count = count + 1;
				}
		}
	}
	var TwoHitChance = Math.round(count * 10000/1521) / 100;
	document.getElementById('KO' + resultslot).innerHTML = TwoHitChance + "% 2HKO";
	// if(TwoHitChance == 100){
	// 	document.getElementById('KO' + resultslot).innerHTML = "Guaranteed 2HKO";
	// }
}

function ThreeHitChecker(maxroll,HP,resultslot){
	count = 0;
	hp = HP;
	var i;
	var j;
	var k;
	for (i = 217; i < 256; i++)
	{
		for (j = 217; j < 256; j++)
		{
			for (k = 217; k < 256; k++){
				damage = Math.floor(maxroll*i/255) + Math.floor(maxroll*j/255) + Math.floor(maxroll*k/255);
				if (damage >= hp){
				count = count + 1;
				}
			}
		}
	}
	var ThreeHitChance = Math.round(count * 10000/59319) / 100
	document.getElementById('KO' + resultslot).innerHTML = ThreeHitChance + "% 3HKO";
	// if(ThreeHitChance == 100){
	// 	document.getElementById('KO' + resultslot).innerHTML = "Guaranteed 3HKO";
	// }
}

function FourHitChecker(maxroll,HP,resultslot){
	count = 0;
	hp = HP;
	var i;
	var j;
	var k;
	var l;
	for (i = 217; i < 256; i++)
	{
		for (j = 217; j < 256; j++)
		{
			for (k = 217; k < 256; k++){

				for (l = 217; l < 256; l++){
					damage = Math.floor(maxroll*i/255) + Math.floor(maxroll*j/255) + Math.floor(maxroll*k/255) + Math.floor(maxroll*l/255);
					if (damage >= hp){
					count = count + 1;
				}
				}

			}
		}
	}
	var FourHitChance = Math.round(count * 10000/2313441) / 100
	document.getElementById('KO' + resultslot).innerHTML = FourHitChance + "% 4HKO";
	// if(FourHitChance == 100){
	// 	document.getElementById('KO' + resultslot).innerHTML = "Guaranteed 4HKO";
	// }
}

function fixedChecker(maxroll,hp,resultslot){
	var hitsToKO = Math.ceil(hp/maxroll);
	document.getElementById('KO' + resultslot).innerHTML = "100% " + hitsToKO + "HKO";
}

</script>
</body>
</html>